/*   OnlineOpinion v5.5.6 Released: 6/8/2012. Compiled 06/08/2012 02:39:28 PM -0500 Branch: master 97ead7060650c0f058f39134c95280ef07ed56bc Components: Full The following code is Copyright 1998-2012 Opinionlab, Inc.  All rights reserved. Unauthorized use is prohibited. This product and other products of OpinionLab, Inc. are protected by U.S. Patent No. 6606581, 6421724, 6785717 B1 and other patents pending. http://www.opinionlab    */var OOo={Browser:function(){var e=navigator.userAgent,t=Object.prototype.toString.call(window.opera)==="[object Opera]",n={IE:!!window.attachEvent&&!t,Opera:t,WebKit:e.indexOf("AppleWebKit/")>-1,Chrome:e.indexOf("Chrome")>-1,Gecko:e.indexOf("Gecko")>-1&&e.indexOf("KHTML")===-1,MobileSafari:/Apple.*Mobile.*Safari/.test(e),PalmPre:e.indexOf("Pre/")>-1,BlackBerry:e.indexOf("BlackBerry")>-1,Fennec:e.indexOf("Fennec")>-1,IEMobile:e.indexOf("IEMobile")>-1,OperaMobile:e.search(/Opera (?:Mobi|Mini)/)>-1,ua:e},r=!1;n.isMobile=n.MobileSafari||n.PalmPre||n.BlackBerry||n.Fennec||n.IEMobile||n.OperaMobile;return n}()};OOo.Cache={};OOo.instanceCount=0;OOo.K=function(){};var OnlineOpinion=OnlineOpinion||OOo;(function(){function e(e){return document.getElementById(e)}function t(e,t){var n;for(n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function n(e,t,n,r){e.addEventListener?e.addEventListener(t,n,r):e.attachEvent&&e.attachEvent("on"+t,n)}function r(e,t,n,r){e.removeEventListener?e.removeEventListener(t,n,r):e.detachEvent&&e.detachEvent("on"+t,n)}function i(e){var t=[],n;for(n in e)e.hasOwnProperty(n)&&t.push(n+"="+(encodeURIComponent(e[n])||""));return t.join("&")}function s(e){var t=i(e.metrics),n=e.tealeafId+"|"+e.clickTalePID+"/"+e.clickTaleUID+"/"+e.ClickTaleGetSID;t+="&custom_var="+OOo.createLegacyVars(e.legacyVariables,n);e.metrics.type==="OnPage"&&(t+="|iframe");e.asm&&(t+="&asm=2");t+="&_rev=2";e.customVariables&&(t+="&customVars="+encodeURIComponent(OOo.serialize(e.customVariables)));return t}function o(e,t){var n=document,r=n.createElement("form"),i=n.createElement("input");r.style.display="none";r.method="post";r.target=t||"OnlineOpinion";r.action=e.onPageCard?"https://secure.opinionlab.com/ccc01/comment_card_json_4_0_b.asp?r="+location.href:"https://secure.opinionlab.com/ccc01/comment_card_d.asp";if(e.commentCardUrl){r.action=e.commentCardUrl;e.onPageCard&&(r.action+="?r="+location.href)}i.name="params";i.value=s(e);r.appendChild(i);n.body.appendChild(r);return r}function u(){return{width:screen.width,height:screen.height,referer:location.href,prev:document.referrer,time1:(new Date).getTime(),time2:null,currentURL:location.href,ocodeVersion:"5.5.6"}}function a(e,t){e=e||{};return typeof e=="string"?t+"|"+e:e.override?e.vars:t+(e.vars?"|"+e.vars:"")}function f(e,t){t||(t=location);return typeof e=="string"?e:e.searchPattern?t.href.replace(e.searchPattern,e.replacePattern):e.replacePattern}var l=function(){var e=document.body,t,n,r,i,s;if(document.createElement&&e&&e.appendChild&&e.removeChild){t=document.createElement("div");if(!t.getBoundingClientRect)return null;t.innerHTML="x";t.style.cssText="position:fixed;top:100px;";e.appendChild(t);n=e.style.height;r=e.scrollTop;e.style.height="3000px";e.scrollTop=500;i=t.getBoundingClientRect().top;e.style.height=n;s=i===100;e.removeChild(t);e.scrollTop=r;return s}return null}(),c=function(){if(navigator.appName==="Microsoft Internet Explorer"&&navigator.userAgent.search("MSIE 6")!==-1)return!0;var e=document.body,t,n;if(document.createElement&&e&&e.appendChild&&e.removeChild){t=document.createElement("iframe");n=!1;t.setAttribute("name","oo_test");t.style.display="none";e.appendChild(t);n=!document.getElementsByName("oo_test")[0];e.removeChild(t);return n}return null}();t(OOo,{extend:t,toQueryString:i,addEventListener:n,$:e,appendOOForm:o,removeEventListener:r,createMetrics:u,createLegacyVars:a,POSITION_FIXED_SUPPORTED:l,DYNAMIC_FRAME_NAME_IS_BUGGY:c,getFormParams:s,referrerRewrite:f})})();(function(){function e(t){if(!t)return null;switch(typeof t){case"number":case"boolean":case"function":return t;case"string":return"'"+t+"'";case"object":var n,r,i,s;if(t.constructor===Array||typeof t.callee!="undefined"){n="[";i=t.length;for(r=0;r<i-1;r+=1)n+=e(t[r])+",";n+=e(t[r])+"]"}else{n="{";for(s in t)t.hasOwnProperty(s)&&(n+=s+":"+e(t[s])+",");n=n.replace(/\,$/,"")+"}"}return n;default:return null}}OOo.extend(OOo,{serialize:e})})();(function(){function e(e,t,n){var r;if(e.search(t[0])!==-1){OOo.createCookie(n,0);return!1}if(OOo.readCookie(n)){r=parseInt(OOo.readCookie(n),10);if(e.search(t[r+1])!==-1&&r+1!==t.length-1){OOo.createCookie(n,r+1);return!1}if(e.search(t[r])!==-1)return!1;if(r+1===t.length-1&&e.search(t.pop())!==-1){OOo.eraseCookie(n);return!0}OOo.eraseCookie(n);return!1}return!1}OOo.extend(OOo,{checkTunnel:e})})();(function(){function e(e){var t="",n;for(n=7;n>=0;n-=1)t+="0123456789abcdef".charAt(e>>n*4&15);return t}function t(e){var t=(e.length+8>>6)+1,n=new Array(t*16),r;for(r=0;r<t*16;r+=1)n[r]=0;for(r=0;r<e.length;r+=1)n[r>>2]|=e.charCodeAt(r)<<24-r%4*8;n[r>>2]|=128<<24-r%4*8;n[t*16-1]=e.length*8;return n}function n(e,t){var n=(e&65535)+(t&65535),r=(e>>16)+(t>>16)+(n>>16);return r<<16|n&65535}function r(e,t){return e<<t|e>>>32-t}function i(e,t,n,r){return e<20?t&n|~t&r:e<40?t^n^r:e<60?t&n|t&r|n&r:t^n^r}function s(e){return e<20?1518500249:e<40?1859775393:e<60?-1894007588:-899497514}function o(o){var u=t(o),a=new Array(80),f=1732584193,l=-271733879,c=-1732584194,h=271733878,p=-1009589776,d,m,g,y,b,E,S,x;for(S=0;S<u.length;S+=16){d=f;m=l;g=c;y=h;b=p;for(x=0;x<80;x+=1){x<16?a[x]=u[S+x]:a[x]=r(a[x-3]^a[x-8]^a[x-14]^a[x-16],1);E=n(n(r(f,5),i(x,l,c,h)),n(n(p,a[x]),s(x)));p=h;h=c;c=r(l,30);l=f;f=E}f=n(f,d);l=n(l,m);c=n(c,g);h=n(h,y);p=n(p,b)}return e(f)+e(l)+e(c)+e(h)+e(p)}OOo.extend(OOo,{sha1:o})})();(function(){function e(e,t){t||(t=location);var n=e.cookieName||"oo_abandon",r=OOo.readCookie(n),i=e.startPage,s=e.endPage,o=e.middle;if(!r){t.pathname.indexOf(i)!==-1&&OOo.createCookie(n);return!1}if(t.pathname.indexOf(s)!==-1){OOo.eraseCookie(n);return!1}if(t.pathname.search(o)!==-1)return!1;OOo.eraseCookie(n);return!0}OOo.extend(OOo,{checkAbandonment:e})})();(function(){function e(e){var t,n;for(t=e.length-1;t>=0;t-=1)if(e[t].read){n=OOo.readCookie(e[t].name);if(!!n&&n===e[t].value)return!0;if(typeof e[t].value=="undefined"&&!!OOo.readCookie(e[t].name))return!0}return!1}function t(e){var t;for(t=e.length-1;t>=0;t-=1)e[t].set&&OOo.createCookie(e[t].name,e[t].value,e[t].expiration)}OOo.extend(OOo,{checkThirdPartyCookies:e,setThirdPartyCookies:t})})();OOo.extend(Function.prototype,function(){function t(e,t){var n=e.length,r=t.length;while(r){r-=1;e[n+r]=t[r]}return e}function n(n,r){n=e.call(n,0);return t(n,r)}function r(t){if(arguments.length<2&&typeof t=="undefined")return this;var r=this,i=e.call(arguments,1);return function(){var e=n(i,arguments);return r.apply(t,e)}}if(typeof Function.prototype.bind!="undefined")return;var e=Array.prototype.slice;return{bind:r}}());(function(){function e(e){e||(e=location);var t;if(e.host.search(/\.[a-z]+/)!==-1){t=e.host.split(".").reverse();if(t.length>3)return e.host;t="."+t[1]+"."+t[0]}else t=e.host;return t}function t(t,n,r){var i="",s="";if(r){i=new Date;i.setTime(i.getTime()+r*1e3);s="; expires="+i.toGMTString()}location.host!==e()?document.cookie=t+"="+n+s+"; path=/; domain="+e()+";":document.cookie=t+"="+n+s+"; path=/;"}function n(e){var t=e+"=",n=document.cookie.split(";"),r,i;for(i=0;i<n.length;i+=1){r=n[i];while(r.charAt(0)===" ")r=r.substring(1,r.length);if(r.indexOf(t)===0)return r.substring(t.length,r.length)}return null}function r(e){t(e,"",-1)}OOo.extend(OOo,{getCookieDomain:e,createCookie:t,readCookie:n,eraseCookie:r})})();OOo.Ocode=function(e){var t=OOo.Browser,n,r;if(e.disableMobile&&t.isMobile)return;if(e.disableNoniOS&&(navigator.userAgent.search("Android")!==-1||t.PalmPre||t.IEMobile||t.OperaMobile||t.Fennec))return;OOo.instanceCount+=1;this.options={tealeafCookieName:"TLTSID"};OOo.extend(this.options,e);n=this.options;r=n.referrerRewrite;n.metrics=OOo.createMetrics();this.frameName=n.onPageCard?"OnlineOpinion"+OOo.instanceCount:"OnlineOpinion";if(n.cookie&&OOo.Ocode.matchUrl(n.cookie,location))return;if(n.thirdPartyCookies&&OOo.checkThirdPartyCookies(n.thirdPartyCookies))return;if(n.abandonment&&!OOo.checkAbandonment(n.abandonment))return;if(n.tunnel&&!OOo.checkTunnel(location.pathname,n.tunnel.path,n.tunnel.cookieName))return;n.events&&n.events.onSingleClick&&(this.singProbability=Math.random()<1-n.events.onSingleClick/100);n.tealeafId=OOo.readCookie(n.tealeafCookieName)||OOo.readCookie(n.sessionCookieName);r&&(n.metrics.referer=OOo.referrerRewrite(r));if(n.events){this.setupEvents();(n.events.disableLinks||n.events.disableFormElements)&&this.setupDisableElements()}n.floating?this.floating():n.bar?this.bar():n.tab&&this.tab()};OOo.Ocode.prototype={show:function(e,t){e==="Tab"&&t&&t.preventDefault&&t.preventDefault();if(this.onPageCardVisible)return;var n=this.options,r;if(this.interruptShow)return;if(!this.floatingLogo&&n.cookie&&OOo.Ocode.matchUrl(n.cookie))return;if(!n.floating&&n.events&&this.singProbability)return;n.events&&n.events.onSingleClick&&(this.singProbability=!0);n.cookie&&OOo.Ocode.tagUrl(n.cookie);if(n.thirdPartyCookies){if(OOo.checkThirdPartyCookies(n.thirdPartyCookies))return;OOo.setThirdPartyCookies(n.thirdPartyCookies)}this.floatingLogo&&this.floatingLogo.children[0].blur();this.floatingLogo&&n.disappearOnClick&&(this.floatingLogo.style.display="none");e&&(n.metrics.trigger=e);if(n.clickTalePID&&typeof window.ClickTale=="function"){n.clickTaleUID=window.ClickTaleGetUID();n.clickTaleSID=window.ClickTaleGetSID()}n.onPageCard?this.setupOnPageCC():this.launchOOPopup();r=n.floating||n.tab||n.bar;r&&typeof r.onClickCallback=="function"&&r.onClickCallback();if(OOo.Browser.IE)return!1}};OOo.extend(OOo.Ocode,{tagUrl:function(e,t){t||(t=location);var n=e.name||"oo_r",r=e.type==="page"?t.href:t.hostname,i=OOo.readCookie(n)||"";if(OOo.Ocode.matchUrl(e,t))return;OOo.createCookie(n,i+OOo.sha1(r),e.expiration)},matchUrl:function(e,t){t||(t=location);var n=OOo.readCookie(e.name||"oo_r"),r;if(!n)return!1;r=e.type==="page"?t.href:t.hostname;return n.search(OOo.sha1(r))!==-1}});(function(){function e(){var e=this.options,t=e.newWindowSize||[545,325],n=[parseInt((e.metrics.height-t[1])/2,10),parseInt((e.metrics.width-t[0])/2,10)],r,i,s="location=no,status=no,width="+t[0]+",height="+t[1]+",top="+n[0]+",left="+n[1];ie7=OOo.Browser.IE&&navigator.userAgent.search("MSIE 7")!==-1;e.metrics.time2=(new Date).getTime();e.metrics.type="Popup";e.asm&&(s+=",scrollbars=1");r=OOo.appendOOForm(e);i=window.open(ie7?e.commentCardUrl||"https://secure.opinionlab.com/ccc01/comment_card_d.asp?"+r.children[0].value:"","OnlineOpinion",s);i&&!ie7&&r.submit()}OOo.extend(OOo.Ocode.prototype,{launchOOPopup:e})})();(function(){function e(){var e=this.options.events,t=[!1,!1],n=["onExit","onEntry"],r=OOo.Browser.Opera?"unload":"beforeunload",i,s,o,u,a;for(o=n.length-1;o>=0;o-=1){i=n[o];if(e[i]instanceof Array){u=e[i];a=u.length;while(a&&!t[o]){a-=1;window.location.href.search(u[a].url)!==-1&&Math.random()>=1-u[a].p/100&&(t[o]=!0)}}else e[i]&&Math.random()>=1-e[i]/100&&(t[o]=!0)}t[0]&&OOo.addEventListener(window,r,this.show.bind(this,"onExit"),!1);t[1]&&(e.delayEntry?window.setTimeout(function(){this.show()}.bind(this,"onEntry"),e.delayEntry*1e3):this.show("onEntry"))}function t(e){var t=e||window.event,n=e.target||e.srcElement,r=this.options.events,i=n.parentNode,s=5,o=0;while(i&&(n.nodeName!=="A"||n.nodeName!=="INPUT")&&o!==s){i.nodeName==="A"&&(n=i);i=i.parentNode;o+=1}r.disableFormElements&&n.tagName==="INPUT"&&(n.type==="submit"||n.type==="image")&&(this.interruptShow=!0);r.disableLinks&&n.nodeName==="A"&&n.href.substr(0,4)==="http"&&n.href.search(r.disableLinks)!==-1&&(this.interruptShow=!0)}function n(e){this.interruptShow=!0}function r(){OOo.addEventListener(document.body,"mousedown",t.bind(this));if(!this.options.events.disableFormElements)return;var e=document.getElementsByTagName("form"),r;for(r=e.length-1;r>=0;r-=1)OOo.addEventListener(e[r],"submit",n.bind(this))}OOo.extend(OOo.Ocode.prototype,{setupEvents:e,setupDisableElements:r})})();OOo.extend(OOo.Ocode.prototype,{floating:function(){function b(e){return e.offsetLeft+e.offsetWidth}function w(e){d.style.left=b(u)+"px"}function E(n){var r=e.documentElement.scrollTop||e.body.scrollTop,i=e.documentElement.clientHeight||document.body.clientHeight;t.style.top=r+i-(g||0)-10+"px"}var e=document,t=this.floatingLogo=document.createElement("div"),n=e.createElement("div"),r=e.createElement("div"),i=e.createElement("div"),s=e.createElement("span"),o=this.options.floating,u=OOo.$(o.contentId),a="10px",f=o.id,l=e.createElement("span"),c,h,p,d,v,m,g,y;l.innerHTML="Screen reader users: Please switch to forms mode for this link.";l.className="screenReader";f&&(t.id=f);t.className="oo_feedback_float";r.className="oo_transparent";n.className="olUp";i.className="olOver";n.tabIndex=0;n.onkeyup=function(e){c=e||window.event;if(c.keyCode!==13)return;this.show()}.bind(this);n.innerHTML=o.caption||"Feedback";t.appendChild(l);t.appendChild(n);s.innerHTML=o.hoverCaption||"Click here to<br>rate this page";i.appendChild(s);t.appendChild(i);t.appendChild(r);if(OOo.Browser.MobileSafari){if(OOo.Browser.ua.search("OS 4")!==-1){h=window.innerHeight;t.style.bottom=null;t.style.top=window.pageYOffset+window.innerHeight-60+"px";y=function(e){p=window.pageYOffset-(h-window.innerHeight);t.style.webkitTransform="translateY("+p+"px)"};OOo.addEventListener(window,"scroll",y,!1);setTimeout(y,100)}}else if(!OOo.POSITION_FIXED_SUPPORTED){t.style.position="absolute";t.style.bottom="";OOo.addEventListener(window,"scroll",E,!1);OOo.addEventListener(window,"resize",E,!1);e.compatMode==="BackCompat"&&(t.style.background="white")}if(o.position&&o.position.search(/Content/)&&u){d=this.spacer=e.createElement("div");v=OOo.Browser.WebKit?e.body:e.documentElement;d.id="oo_feedback_fl_spacer";d.style.left=b(u)+"px";e.body.appendChild(d);switch(o.position){case"rightOfContent":m=function(e){t.style.left=b(u)-v.scrollLeft+"px";OOo.POSITION_FIXED_SUPPORTED||(m=null)};break;case"fixedPreserveContent":m=function(n){var r=OOo.Browser.IE?e.body.clientWidth:window.innerWidth,i=OOo.POSITION_FIXED_SUPPORTED?v.scrollLeft:0;if(r<=b(u)+t.offsetWidth+parseInt(a,10))t.style.left=b(u)-i+"px";else{t.style.left="";t.style.right=a}};break;case"fixedContentMax":m=function(n){var r=OOo.Browser.IE?e.body.clientWidth:window.innerWidth;if(r<=b(u)+t.offsetWidth+parseInt(a,10)){t.style.left="";t.style.right=a;!OOo.POSITION_FIXED_SUPPORTED&&n&&n.type==="scroll"&&(t.style.left=e.body.clientWidth+e.body.scrollLeft-105+"px")}else{t.style.left=b(u)-v.scrollLeft+"px";t.style.right=""}}}window.setTimeout(m,0);OOo.addEventListener(window,"scroll",m,!1);OOo.addEventListener(window,"resize",m,!1);OOo.addEventListener(window,"resize",w,!1)}else t.style.right=a;OOo.addEventListener(t,"click",this.show.bind(this,"Floating"),!1);OOo.addEventListener(t,"touchstart",this.show.bind(this,"Floating"),!1);e.body.appendChild(t);if(!OOo.POSITION_FIXED_SUPPORTED&&!OOo.Browser.MobileSafari){r.style.height=t.clientHeight+"px";g=t.clientHeight;setTimeout(E,100)}},removeFloatingLogo:function(){document.body.removeChild(this.floatingLogo);this.spacer&&document.body.removeChild(this.spacer)}});OOo.extend(OOo.Ocode.prototype,{bar:function(){function u(e){var t=curtop=0;if(e.offsetParent){do{t+=e.offsetLeft;curtop+=e.offsetTop}while(e=e.offsetParent);return[t,curtop]}}function a(e){var n=document.activeElement,r;if(!n)return;r=u(n);if(!r)return;r[1]+n.clientHeight>(window.innerHeight||document.body.clientHeight)+(window.pageYOffset||document.body.scrollTop)-t.clientHeight&&window.scrollBy(0,n.clientHeight+20)}var e=document,t=this.floatingLogo=e.createElement("div"),n=e.createElement("span"),r,i,s,o=e.documentElement.scrollTop||e.body.scrollTop;this.reflowBar=OOo.K;t.id="oo_bar";n.innerHTML=this.options.bar.caption||"Feedback";t.appendChild(n);t.tabIndex=0;t.onkeyup=function(e){var t=e||window.event;if(t.keyCode!==13)return;this.show()}.bind(this);OOo.addEventListener(t,"click",this.show.bind(this,"Bar"));document.body.className+=document.body.className<1?"oo_bar":" oo_bar";document.body.appendChild(t);if(OOo.Browser.IE){e.compatMode==="CSS1Compat"?r=function(n){n&&n.type==="resize"&&setTimeout(r,50);t.style.top=e.documentElement.scrollTop+document.documentElement.clientHeight-t.clientHeight-1+"px";t.style.width=Math.max(e.documentElement.clientWidth,e.body.offsetWidth)+"px"}:r=function(n){t.style.top=e.body.scrollTop+document.body.clientHeight-t.clientHeight-1+"px";t.style.width=Math.max(e.documentElement.clientWidth,e.body.offsetWidth)-22+"px"};t.style.position="absolute";OOo.addEventListener(window,"scroll",r,!1);OOo.addEventListener(window,"resize",r,!1);this.reflowBar=function(){t.style.display="none";r();t.style.display="block"};r()}else if(OOo.Browser.MobileSafari&&OOo.Browser.ua.search("OS 4")!==-1){i=window.innerHeight;t.style.bottom=null;t.style.top=window.pageYOffset+window.innerHeight-22+"px";r=function(e){s=window.pageYOffset-(i-window.innerHeight);t.style.webkitTransform="translateY("+s+"px)"};OOo.addEventListener(window,"scroll",r,!1);setTimeout(r,100)}OOo.addEventListener(document.body,"keyup",a,!1)}});OOo.extend(OOo.Ocode.prototype,{tab:function(){function s(n){var r=e.documentElement.scrollTop||e.body.scrollTop,s=e.documentElement.scrollLeft||e.body.scrollLeft,o=e.documentElement.clientHeight||document.body.clientHeight;t.style.top=r+(o/2-t.clientHeight/2)+"px";if(!i.position||i.position==="right")t.style.right=-1*s+2+"px"}function o(e){t.style.top=pageYOffset+(innerHeight/2-t.clientHeight/2)+"px";t.style.right=document.documentElement.clientWidth-window.innerWidth-window.pageXOffset-15+"px"}var e=document,t=this.floatingLogo=e.createElement("div"),n=e.createElement("div"),r=e.createElement("span"),i=this.options.tab;t.id="oo_tab";t.className="oo_tab_"+(i.position||"right");if(!OOo.POSITION_FIXED_SUPPORTED&&!OOo.Browser.MobileSafari){t.style.position="absolute";if((!i.position||i.position==="right")&&OOo.Browser.IE){t.className+=" oo_tab_ie_right";if(OOo.Browser.ua.search("IE 6")===-1){OOo.addEventListener(window,"scroll",s,!1);OOo.addEventListener(window,"resize",s,!1)}}}t.tabIndex=0;t.onkeyup=function(e){var t=e||window.event;if(t.keyCode!==13)return;this.show()}.bind(this);n.appendChild(r);t.appendChild(n);OOo.addEventListener(t,"click",this.show.bind(this,"Tab"),!1);e.body.appendChild(t);if(OOo.Browser.MobileSafari&&OOo.Browser.ua.search("OS 4")!==-1){t.style.position="absolute";OOo.addEventListener(window,"scroll",o,!1);setTimeout(o,100)}}});OOo.extend(OOo.Ocode.prototype,{setupOnPageCC:function(){function T(r){r&&r.preventDefault&&r.preventDefault();document.body.focus();u.tabIndex=-1;u.title="empty";u["aria-hidden"]="true";t.style.display="none";t.className="";e.body.removeChild(n);window.postMessage?OOo.removeEventListener(window,"message",E):window.clearInterval(p);v=!1;m.onPageCardVisible=!1;return!1}var e=document,t=OOo.Cache.overlay||e.createElement("div"),n=this.wrapper=e.createElement("div"),r=e.createElement("div"),i=e.createElement("div"),s=e.createElement("span"),o=this.frameName,u=e.createElement(OOo.DYNAMIC_FRAME_NAME_IS_BUGGY?'<iframe name="'+o+'">':"iframe"),a=e.createDocumentFragment(),f=this.options,l=f.onPageCard,c="https://secure.opinionlab.com/ccc01/comment_card_json_4_0_b.asp",h,p,d,v=!1,m=this,g,y,b,w,E,S,x;E=OOo.Ocode.postMessageHandler(function(r){var i=parseInt(r,10),o,a;if(i>0){if(v)return;v=!0;o=window.innerHeight||e.documentElement.clientHeight||e.body.clientHeight;a=i;x=n.offsetTop;if(a+x>o){a=o-40-x;u.style.width="555px"}u.style.height=a+"px";n.style.visibility="visible";s.clientHeight<20&&(s.style.height=n.offsetHeight+"px");t.className="no_loading";m.onPageCardVisible=!0}else r==="submitted"&&T();OOo.Browser.IE&&e.compatMode==="BackCompat"&&window.scrollTo(0,0)},m.options.commentCardUrl);f.metrics.type="OnPage";OOo.Cache.overlay=t;t.id="oo_overlay";t.style.display="block";t.className="";i.className="iwrapper";n.className="oo_cc_wrapper";r.className="oo_cc_close";r.innerHTML="X";n.style.visibility="hidden";if(OOo.Browser.IE){u.frameBorder="0";if(!window.XMLHttpRequest||e.compatMode==="BackCompat"){S=Math.max(e.documentElement.clientWidth,e.body.offsetWidth);t.style.position="absolute";t.style.width=e.compatMode==="BackCompat"?S-21+"px":S+"px";t.style.height=Math.max(e.documentElement.clientHeight,e.body.offsetHeight)+"px";n.style.position="absolute";OOo.addEventListener(window,"scroll",function(){t.style.top=e.body.scrollTop+document.body.clientHeight-t.clientHeight+"px";n.style.top=e.body.scrollTop+x+25+"px"})}}OOo.addEventListener(r,"click",T);if(l.closeWithOverlay&&!OOo.Browser.isMobile){n.appendChild(s);s.onclick=T;t.onclick=T}u.src=" ";u.name=o;i.appendChild(r);i.appendChild(u);n.appendChild(i);a.appendChild(n);a.appendChild(t);e.body.appendChild(a);window.postMessage?OOo.addEventListener(window,"message",E):p=setInterval(E,500);f.metrics.time2=(new Date).getTime();h=OOo.appendOOForm(f,o);h.submit()}});OOo.extend(OOo.Ocode,{postMessageHandler:function(e,t,n){return function(r){var i="https://secure.opinionlab.com",s;n||(n=location);t&&(t=t.match(/(https?:\/\/.*?)\/|$/)[1]);if(r&&r.origin!==i&&r.origin!==t||!r&&n.hash.search("OL=")===-1)return!1;s=r?r.data:n.hash.split("=").pop();!r&&location.hash&&(location.hash="");e(s);return s}}});OOo.Invitation=function(e){if(OOo.Browser.isMobile)return;this.options={tunnelCookie:"oo_inv_tunnel",repromptTime:604800,responseRate:50,repromptCookie:"oo_inv_reprompt",promptMarkup:"oo_inv_prompt.html",promptStyles:"oo_inverstitial_style.css",percentageCookie:"oo_inv_percent",pagesHitCookie:"oo_inv_hit",popupType:"popunder",promptDelay:0,neverShowAgainButton:!1,loadPopupInBackground:!1,tealeafCookieName:"TLTSID",monitorWindow:"oo_inv_monitor.html",beforePrompt:OOo.K};this.popupShown=!1;OOo.extend(this.options,e);var t=this.options,n=parseInt(OOo.readCookie(t.pagesHitCookie),10)||0;OOo.Invitation.friendlyDomains=t.friendlyDomains||null;if(location.search.search("evs")!==-1){t.loadPopupInBackground=!0;this.launchPopup();OOo.createCookie(t.repromptCookie,1,t.repromptTime===-1?0:t.repromptTime)}setTimeout(function(){if(!window.oo_inv_monitor)return;if(t.area&&location.href.search(t.area)===-1){this.options.popupType="popup";this.launchPopup()}else t.goal&&location.href.search(t.goal)!==-1&&window.oo_inv_monitor.close()}.bind(this),1600);if(OOo.readCookie(t.repromptCookie))return;if(t.thirdPartyCookies&&OOo.checkThirdPartyCookies(t.thirdPartyCookies))return;OOo.readCookie(t.percentageCookie)||OOo.createCookie(t.percentageCookie,Math.random()>1-t.responseRate/100?"1":"0");if(typeof t.promptTrigger!="undefined")if(t.promptTrigger instanceof RegExp){if(!window.location.href.match(t.promptTrigger))return}else if(t.promptTrigger instanceof Array&&!OOo.checkTunnel(location.pathname,t.promptTrigger,t.tunnelCookie))return;n+=1;OOo.createCookie(t.pagesHitCookie,n);if(t.pagesHit&&n<t.pagesHit)return;OOo.eraseCookie(t.tunnelCookie);OOo.readCookie(t.percentageCookie)==="1"&&window.setTimeout(function(){OOo.createCookie(t.repromptCookie,1,t.repromptTime);this.options.beforePrompt();this.getPrompt()}.bind(this),t.promptDelay*1e3)};OOo.Invitation.prototype={getPrompt:function(){var e=window.XMLHttpRequest?new XMLHttpRequest:new window.ActiveXObject("Microsoft.XMLHTTP"),t=this,n=document.createElement("link"),r;e.onreadystatechange=function(){if(e.readyState!==4)return;t.showPrompt(e.responseText)};e.open("GET",this.options.pathToAssets+this.options.promptMarkup,!0);e.send(null)},showPrompt:function(e){var t=document,n=t.createElement("div"),r=t.createElement("div"),i,s,o=this.options,u;r.id="oo_invitation_overlay";n.id="oo_container";n.style.visibility="hidden";n.innerHTML=e;n.appendChild(r);t.body.appendChild(n);u=OOo.$("oo_launch_prompt");if(o.companyLogo){i=new Image;i.src=o.companyLogo;OOo.$("oo_company_logo").appendChild(i)}OOo.addEventListener(u,"click",this.launchPopup.bind(this),!1);if(o.clickCallbacks){typeof o.clickCallbacks.yes=="function"&&OOo.addEventListener(u,"click",function(){o.clickCallbacks.yes()},!1);typeof o.clickCallbacks.no=="function"&&OOo.addEventListener(OOo.$("oo_no_thanks"),"click",function(){o.clickCallbacks.no()},!1)}if(o.neverShowAgainButton){s=OOo.$("oo_never_show");s.style.visibility="visible";OOo.addEventListener(s,"click",this.killPrompt.bind(this),!1)}if(OOo.Browser.IE&&!window.XMLHttpRequest){r.style.position="absolute";r.style.width=Math.max(document.documentElement.clientWidth,document.body.offsetWidth)+"px";r.style.height=Math.max(document.documentElement.clientHeight,document.body.offsetHeight)+"px";n.style.position="absolute"}n.style.visibility="visible";r.className="no_loading"},launchPopup:function(){if(this.popupShown)return;this.popupShown=!0;var e=this.options,t=window.location.href,n=e.popupType==="popup"?"https://secure.opinionlab.com/ccc01/comment_card.asp?":e.pathToAssets+e.monitorWindow+"?"+(new Date).getTime()+"&",r,i=[],s=e.asm?[555,500]:[400,335],o,u=OOo.createMetrics(),a=OOo.readCookie(e.tealeafCookieName);e.clickTalePID&&window.ClickTaleGetUID&&window.ClickTaleGetSID&&(a+="|"+[e.clickTalePID,window.ClickTaleGetUID(),window.ClickTaleGetSID()].join("/"));s=e.newWindowSize||s;e.referrerRewrite&&(u.referer=OOo.referrerRewrite(e.referrerRewrite));e.thirdPartyCookies&&OOo.setThirdPartyCookies(e.thirdPartyCookies);r=OOo.toQueryString(u)+"&type=Invitation";e.customVariables&&(r+="&customVars="+encodeURIComponent(OOo.serialize(e.customVariables)));r+="&custom_var="+OOo.createLegacyVars(e.legacyVariables,a);o=window.open(n+r,"OnlineOpinionInvitation","location=no,status=no,width="+s[0]+",height="+s[1]);!e.loadPopupInBackground&&OOo.$("oo_container")&&OOo.Invitation.hidePrompt();if(e.popupType==="popunder")if(!OOo.Browser.Chrome){o.blur();window.focus()}else{e.loadPopupInBackground||window.alert(e.chromeMainWinPrompt||"Please fill out the form behind this window when you are finished.");e.chromeSurveyPrompt&&setTimeout(function(t){o.postMessage(e.chromeSurveyPrompt,"*")},500)}else if(window.oo_inv_monitor){window.blur();o.focus()}},killPrompt:function(){this.options.clickCallbacks&&typeof this.options.clickCallbacks.no=="function"&&this.options.clickCallbacks.no();OOo.createCookie(this.options.repromptCookie,1,15768e4);OOo.Invitation.hidePrompt()}};OOo.extend(OOo.Invitation,{hidePrompt:function(){OOo.$("oo_container").style.display="none"},navigateToFriendlyDomain:function(e){location.href=e}});